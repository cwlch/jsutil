<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../lib/jsutil-umd.js"></script>
</head>
<body>


<div class="ctx">
    <h1>节流函数：_Throttle</h1>
    <p>看计数。连续狂点,每<b>2秒</b>计数1次哦~</p>
    <button  id="content" class="btn">请疯狂点我</button>
     <b id="count" >0</b>
</div>
<script>
    var _Throttle = function (fn, delay, type) {
        if (delay === void 0) { delay = 500; }
        if (type === void 0) { type = 1; }
        var previous = 0, timer;
        if (jsutil._GetVarType([]) !== 'function') {
            throw new Error('fn需要为函数哦！');
        }
        return function (args) {
            if (type === 1 || type === 3) {
                var now = Date.now();
                // 当前时间-先前时间 > 延迟时间
                if (now - previous > delay) {
                    fn(args);
                    previous = now;
                }
            }
            if (type === 2 || type === 3) {
                if (!timer) {
                    timer = setTimeout(function () {
                        clearTimeout(timer);
                        timer = null;
                        fn(args);
                    }, delay);
                }
            }
        };
    };
    let num = 1;
    const $content = document.getElementById('content');
    const $count = document.getElementById('count');
    function count(val) {
        console.log(val);
        $count.innerHTML = num++;
    };
    let throttleCount = _Throttle(count, 2000, 3)
    $content.onclick = () => {
        throttleCount('throttleCount')
    }
</script>
<style>
    .ctx{
        height:150px;
        text-align:center; color: #353e56;font-size:16px;
    }
    .btn{
        border:0;
        background: #44c843; color: #353e56;
        cursor: pointer;
        height: 36px;
        font-size: 16px;
    }
</style>
</body>
</html>
